-------------------------------------------------------------------------------------------------------------
–í —ç—Ç–æ–º —Ä–∞–∑–¥–µ–ª–µ –≤—ã–ø–æ–ª–Ω–∏–º –ø—Ä–æ–≤–µ—Ä–∫—É —Ä–µ–¥–∏—Å—Ç—Ä–∏–±—É—Ü–∏–∏ –º–∞—Ä—à—Ä—É—Ç–æ–≤ –∏–∑ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ ISIS –≤ BGP –Ω–∞ –æ—Å–Ω–æ–≤–∞–Ω–∏–∏ –∑–Ω–∞—á–µ–Ω–∏—è route-type (path-type). 
–£—Å—Ç–∞–Ω–æ–≤–∫—É –∞—Ç—Ä–∏–±—É—Ç–æ–≤ –¥–ª—è –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º—ã—Ö –ø—Ä–µ—Ñ–∏–∫—Å–æ–≤ –Ω–µ –≤—ã–ø–æ–ª–Ω—è—Ç—å, —Ç.–∫. –ø—Ä–æ–≤–µ—Ä–µ–Ω–æ –≤ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞—Ö.
-------------------------------------------------------------------------------------------------------------
8.1. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
8.1.1. –£–¥–∞–ª–∏—Ç—å –ø—Ä–∞–≤–∏–ª–∞

–£–¥–∞–ª–∏—Ç—å –∏–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –ø—Ä–∞–≤–∏–ª–∞ —Ä–µ–¥–∏—Å—Ç—Ä–∏–±—É—Ü–∏–∏.

üö©Ô∏è–î–ª—è atDR1

configure
router bgp 64050
  address-family vpnv4 unicast
    no redistribution isis CE1
    no redistribution isis CE2
  exit
  address-family vpnv6 unicast
    no redistribution isis CE1
    no redistribution isis CE2
  exit
exit
commit

	
üö©Ô∏è–î–ª—è atAR1
configure
router bgp 64051
  address-family vpnv4 unicast
    no redistribution isis CE1
    no redistribution isis CE2
    no redistribution isis CE3
  exit
  address-family vpnv6 unicast
    no redistribution isis CE1
    no redistribution isis CE2
    no redistribution isis CE3
  exit
exit
commit

	
üö©Ô∏è–î–ª—è atAR2
configure
router bgp 64052
  address-family vpnv4 unicast
    no redistribution isis CE1-CE3
    no redistribution isis CE2
  exit
  address-family vpnv6 unicast
    no redistribution isis CE1-CE3
    no redistribution isis CE2
  exit
exit
commit

8.1.2. –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ –ø—Ä–∞–≤–∏–ª–∞

üö©Ô∏è–î–ª—è atDR1

router bgp 64050
  address-family vpnv4 unicast
    redistribution isis l2-internal
      match path-type isis-level2-internal
    exit
  exit
  address-family vpnv6 unicast
    redistribution isis l2-external
      match path-type isis-level2-external
    exit
    redistribution isis l2-internal
      match path-type isis-level2-internal
    exit
  exit
exit

	
üö©Ô∏è–î–ª—è atAR1
router bgp 64051
  address-family vpnv4 unicast
    redistribution isis l1-internal
      match path-type isis-level2-internal
    exit
  exit
  address-family vpnv6 unicast
    redistribution isis l1-internal
      match path-type isis-level2-internal
    exit
  exit
exit


	
üö©Ô∏è–î–ª—è atAR2

router bgp 64052
  address-family vpnv4 unicast
    redistribution isis tag_isis
      match admin-tag 100
    exit
  exit
  address-family vpnv6 unicast
    redistribution isis tag_isis
      match admin-tag 100
    exit
  exit
exit


8.2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –º–∞—Ä—à—Ä—É—Ç–æ–≤

–î–ª—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤ atDR1, atAR1 –∏ atAR2 –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–º–∞–Ω–¥—ã

     show bgp vpnv4 unicast
    show bgp vpnv6 unicast,


–ø—Ä–æ–∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–∑ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –ø–æ –∫–∞–∂–¥–æ–π –∫–æ–º–∞–Ω–¥–µ –≤—ã–≤–æ–¥ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø—Ä–µ—Ñ–∏–∫—Å–æ–≤ (Total entries) –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å —Ç–∞–±–ª–∏—Ü–µ–π –Ω–∏–∂–µ. 
–î–ª—è –ø—Ä–∏–º–µ—Ä–∞ –ø—Ä–∏–≤–µ–¥—ë–Ω –≤—ã–≤–æ–¥ –≤—Å–µ—Ö show –∫–æ–º–∞–Ω–¥ –Ω–∞ –≤—Å–µ—Ö —Ä–æ—É—Ç–µ—Ä–∞—Ö.

üö©Ô∏è–¥–ª—è atDR1:

0/FMC0:atDR1# show bgp vpnv4 unicast 
Fri Aug  2 14:17:26 2024
  BGP router identifier 10.0.0.50, local AS number 64050 
  Graceful Restart is disabled
  BGP table state: active
  
  Status codes: d damped, h history, > best, b backup, S stale, * active, u untracked, i internal
  Origin codes: i igp, e egp, ? incomplete
  
  Route Distinguisher        IP Prefix             Next hop         Metric  Rcvd/Lcl label  LocPrf  Weight  Path 
  -------------------------- --------------------- ---------------- ------- --------------- ------- ------- ----- 
  u>   123:123               6.6.6.132/32                           0       -/19            100     32768   ? 
  u>   123:123               60.60.60.0/24                          0       -/19            100     32768   ? 
  u>   123:123               192.168.113.0/24                       0       -/19            100     32768   ? 
  u>   223:223               10.0.0.52/32                           0       -/17            100     32768   ? 
  u>   223:223               172.22.2.0/24                          0       -/17            100     32768   ? 

  Total entries: 5
0/FMC0:atDR1#

0/FMC0:atDR1# show bgp vpnv6 unicast 
Fri Aug  2 14:17:31 2024
  BGP router identifier 10.0.0.50, local AS number 64050 
  Graceful Restart is disabled
  BGP table state: active
  
  Status codes: d damped, h history, > best, b backup, S stale, * active, u untracked, i internal
  Origin codes: i igp, e egp, ? incomplete
  
  Route Distinguisher        IP Prefix                                    Next hop                                 Metric  Rcvd/Lcl label  LocPrf  Weight  Path 
  -------------------------- -------------------------------------------- ---------------------------------------- ------- --------------- ------- ------- ----- 
  u>   123:123               2001:60:60::/64                                                                       0       -/19            100     32768   ? 
  u>   123:123               2001:192:168:113::/64                                                                 0       -/19            100     32768   ? 
  u>   123:123               2003:0:6:6::132/128                                                                   0       -/19            100     32768   ? 
  u>   223:223               2001:172:22:2::/64                                                                    0       -/17            100     32768   ? 
  u>   223:223               2003:0:52:52::52/128                                                                  0       -/17            100     32768   ? 

  Total entries: 5
0/FMC0:atDR1#


üö©Ô∏è–¥–ª—è atAR1:

0/ME5100:atAR1# show bgp vpnv4 unicast 
Fri Aug  2 13:26:23 2024
  BGP router identifier 10.0.0.51, local AS number 64051 
  Graceful Restart is disabled
  BGP table state: active
  
  Status codes: d damped, h history, > best, b backup, S stale, * active, u untracked, i internal
  Origin codes: i igp, e egp, ? incomplete
  
  Route Distinguisher        IP Prefix             Next hop         Metric  Rcvd/Lcl label  LocPrf  Weight  Path 
  -------------------------- --------------------- ---------------- ------- --------------- ------- ------- ----- 
  u>   123:123               7.7.7.132/32                           0       -/18            100     32768   ? 
  u>   123:123               70.70.70.0/24                          0       -/18            100     32768   ? 
  u>   123:123               192.168.114.0/24                       0       -/18            100     32768   ? 
  u>   223:223               4.4.4.132/32                           0       -/17            100     32768   ? 
  u>   223:223               40.40.40.0/24                          0       -/17            100     32768   ? 
  u>   223:223               192.168.109.0/24                       0       -/17            100     32768   ? 
  u>   323:323               10.0.0.50/32                           0       -/16            100     32768   ? 
  u>   323:323               172.22.1.0/24                          0       -/16            100     32768   ? 

  Total entries: 8
0/ME5100:atAR1#

0/ME5100:atAR1# show bgp vpnv6 unicast 
Fri Aug  2 13:26:40 2024
  BGP router identifier 10.0.0.51, local AS number 64051 
  Graceful Restart is disabled
  BGP table state: active
  
  Status codes: d damped, h history, > best, b backup, S stale, * active, u untracked, i internal
  Origin codes: i igp, e egp, ? incomplete
  
  Route Distinguisher        IP Prefix                                    Next hop                                 Metric  Rcvd/Lcl label  LocPrf  Weight  Path 
  -------------------------- -------------------------------------------- ---------------------------------------- ------- --------------- ------- ------- ----- 
  u>   323:323               2001:172:22:1::/64                                                                    0       -/16            100     32768   ? 
  u>   323:323               2003:0:50:50::50/128                                                                  0       -/16            100     32768   ? 

  Total entries: 2
0/ME5100:atAR1#


üö©Ô∏è–¥–ª—è atAR2:

0/ME5200:atAR2# show bgp vpnv4 unicast 
Fri Aug  2 14:08:04 2024
  BGP router identifier 10.0.0.52, local AS number 64052 
  Graceful Restart is disabled
  BGP table state: active
  
  Status codes: d damped, h history, > best, b backup, S stale, * active, u untracked, i internal
  Origin codes: i igp, e egp, ? incomplete
  
  Route Distinguisher        IP Prefix             Next hop         Metric  Rcvd/Lcl label  LocPrf  Weight  Path 
  -------------------------- --------------------- ---------------- ------- --------------- ------- ------- ----- 
  u>   123:123               10.0.0.4/32                            0       -/16            100     32768   ? 

  Total entries: 1
0/ME5200:atAR2# 

0/ME5200:atAR2# show bgp vpnv6 unicast 
Fri Aug  2 14:08:07 2024
  BGP router identifier 10.0.0.52, local AS number 64052 
  Graceful Restart is disabled
  BGP table state: active
  
  Status codes: d damped, h history, > best, b backup, S stale, * active, u untracked, i internal
  Origin codes: i igp, e egp, ? incomplete
  
  Route Distinguisher        IP Prefix                                    Next hop                                 Metric  Rcvd/Lcl label  LocPrf  Weight  Path 
  -------------------------- -------------------------------------------- ---------------------------------------- ------- --------------- ------- ------- ----- 
  u>   123:123               2003:0:10:10::4/128                                                                   0       -/16            100     32768   ? 

  Total entries: 1
0/ME5200:atAR2#


–ó–Ω–∞—á–µ–Ω–∏—è "Total entries" –ø–æ –∫–∞–∂–¥–æ–º—É —É—Å—Ç—Ä–æ–π—Å—Ç–≤—É:
-----------------------------------
   show bgp vpnv4 unicast         |
   show bgp vpnv6 unicast         | 
-----------------------------------
–ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä  | Total entries    |
atDR1          |       5          |
-----------------------------------
               |    vpnv4 - 8     |
atAR1          |    vpnv6 - 2     |
-----------------------------------
atAR2          |        1         |
-----------------------------------

8.3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–µ—Ñ–∏–∫—Å–æ–≤

–î–ª—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤ atDR1, atAR1 –∏ atAR2 –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–º–∞–Ω–¥—ã

    show bgp vpnv4 unicast
    show bgp vpnv6 unicast,

–ø—Ä–æ–∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–∑ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –ø–æ –∫–∞–∂–¥–æ–π –∫–æ–º–∞–Ω–¥–µ –Ω–∞–ª–∏—á–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –ø—Ä–µ—Ñ–∏–∫—Å–æ–≤ (IP Prefix) –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å —Ç–∞–±–ª–∏—Ü–µ–π –Ω–∏–∂–µ.


–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ —Å–ª–µ–¥—É—é—â–∏—Ö –ø—Ä–µ—Ñ–∏–∫—Å–æ–≤ "IP Prefix" –≤ –≤—ã–≤–æ–¥–µ show –∫–æ–º–∞–Ω–¥ –ø–æ –∫–∞–∂–¥–æ–º—É —É—Å—Ç—Ä–æ–π—Å—Ç–≤—É:
-----------------------------------
     show bgp vpnv4 unicast       |
-----------------------------------
–ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä   |  IP Prefix      |
-----------------------------------
atDR1	        |6.6.6.132/32     |
                |60.60.60.0/24    |
                |192.168.113.0/24 |
                |10.0.0.52/32     |
                |172.22.2.0/24    |
-----------------------------------
atAR1	        |7.7.7.132/32     |
                |70.70.70.0/24    |
                |192.168.114.0/24 |
                |4.4.4.132/32     |
                |40.40.40.0/24    | 
                |192.168.109.0/24 |
                |10.0.0.50/32     |
                |172.22.1.0/24    |
-----------------------------------
atAR2           |10.0.0.4/32      |
-----------------------------------
     show bgp vpnv6 unicast       |
-----------------------------------
–ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä |    IP Prefix      |
-----------------------------------
atDR1         |2003:0:6:6::132/128   |
              |2001:192:168:113::/64 |
              |2001:60:60::/64       |
              |2003:0:52:52::52/128  | 
              |2001:172:22:2::/64    |
-------------------------------------  
atAR1         |2001:172:22:1::/64    |
              |2003:0:50:50::50/128  |
-------------------------------------|
atAR2         |2003:0:10:10::4/128   |
-------------------------------------

9. –†–∞–∑–æ–±—Ä–∞—Ç—å BGP
üö©Ô∏è–¥–ª—è atDR1:
configure 
no router bgp 64050
commit

	
üö©Ô∏è–¥–ª—è atAR1:
configure 
no router bgp 64051
commit 

	
üö©Ô∏è–¥–ª—è atAR2:
configure 
no router bgp 64052
commit
